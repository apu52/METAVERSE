<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Rating App</title>

     <!-- toastify link -->
     <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @keyframes shine {
            0% {
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }

            50% {
                text-shadow: 0 0 20px rgba(255, 255, 255, 1);
            }

            100% {
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }
        }

        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #1a1a2e;
        }
        .navbar {
            background-color: #16213e;
            /* Dark background for the navbar */
            color: white;
            padding: 15px 0;
            position: fixed;
            top: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            
        }

        .navbar .nav-wrapper {
            display: flex;
            gap: 160px;
            margin-top: 7px;
        }

        .navbar .nav-link {
            position: relative;
           
            color: white;
            text-decoration: none;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            padding: 5px;
           
            transition: color 0.3s ease;
            
        }

        .navbar .nav-link i {
            margin-right: 8px;
        }

        .navbar .nav-link::after {
            content: "";
            position: absolute;
            left: 0;
            bottom: -2px;
           
            width: 0%;
            
            height: 2px;
            
            background-color: #007bff;
            
            transition: width 0.4s ease;
            
        }

        .navbar .nav-link:hover {
            color: #007bff;
            
        }

        .navbar .nav-link:hover::after {
            width: 100%;
            
        }

        .hamburger {
        display: none;
        cursor: pointer;
      }

      .hamburger i {
        color: white;
        font-size: 24px;
      }

      @media (max-width: 1000px) {
        .hamburger {
          color: white;
          display: block;
          margin-left: auto;
          margin-right: 2rem;
        }  
        
        .nav-cont{
          display: none;
        }

        .nav-cont.active {
          display: flex;
          flex-direction:column;
          align-items: center;
        }
    }

        .stargaze {
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            position: fixed;
            transform: translate(-50%, -50%);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .stargaze video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.5) contrast(1.2) saturate(1.5);
        }

        .container {
            border: 2px solid #007bff;
            height: auto;
            padding: 20px;
            text-align: center;
            background-color: rgba(22, 33, 62, 0.9);
            color: white;
            transition: transform 0.2s, box-shadow 0.2s;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 600px;
        }

        .container:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
        }

        .emoji {
            font-size: 2.5rem;
            cursor: pointer;
            margin: 0 15px;
            transition: transform 0.2s, text-shadow 0.2s;
        }

        .emoji:hover {
            transform: scale(3.5);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .emoji.selected {
            transform: scale(1.5);
            animation: shine 1s infinite;
        }

        .textarea-container {
            margin-top: 20px;
        }

        textarea {
            width: 90%;
            height: 120px;
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #007bff;
            border-radius: 5px;
            background-color: #1a1a2e;
            color: white;
        }

        .email-container {
            margin: 20px 0;
            padding: 4px;
        }

        .email-container input {
            width: 90%;
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #007bff;
            border-radius: 5px;
            background-color: #1a1a2e;
            color: white;
        }

        .submit-button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: 2px solid transparent;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease, border-color 0.4s ease;
        }

        .submit-button:hover {
            background-color: #0056b3;
            transform: scale(1.1);
            box-shadow: 0px 4px 15px rgba(0, 123, 255, 0.4);
            border-color: #00aaff;
        }

        .submit-button:active {
            transform: scale(1);
            box-shadow: none;
        }
    </style>
</head>

<body>

    <script>

        function showToast(message, type) {
            Toastify({
              text: message,
              duration: 3000, // Duration in milliseconds
              close: false, // Show a close button
              gravity: 'top', // 'top' or 'bottom'
              position: 'right', // 'left', 'center', or 'right'
              backgroundColor: type === 'error' ? 'red' : 'green', // Customize colors based on type
              stopOnFocus: true, // Stop when focused
              style: {
              width: '400px', // Set the width here
              fontSize: '20px', // Optional: Adjust font size
              height:'5rem',
              paddingTop:'1.5rem'
            },
            }).showToast();
          }
        
            //  window.addEventListener('load',()=>{
            //   const login = document.getElementById('overlay');
            //   const preloader = document.getElementById('preloader');
             
            //   setTimeout(() => {
            //        preloader.style.display = 'none'; 
            //        login.style.display = 'block'; 
            //   }, 1000);
            // });
        
            function closeOverlay() {
                    document.getElementById('overlay').style.display = 'none';
                }
        
        
              function switchSignUp(){
                showToast('Switching to Sign-Up form.', 'info');
                 const sign = document.getElementById('signUp'); 
                const login = document.getElementById('overlay');
        
                 login.style.display = 'none'; 
                 sign.style.display='block';
              }
        
              function switchLogin(){
                showToast('Switching to Log-In form.', 'info');
                const sign = document.getElementById('signUp'); 
                const login = document.getElementById('overlay');
        
                login.style.display = 'block';
                sign.style.display = 'none';
              }
        
              function validateLoginInForm(){
                let email = document.getElementById('email').value.trim();
                let password = document.getElementById('password').value.trim();
              
                if(!email){
                  showToast('Please Enter your email','error');
                  return false; 
                }
        
                if(!password){
                  showToast('Please Enter your password','error');
                  return; 
                }
        
                if(email && password){
                  closeOverlay();
                  setTimeout(function() {
        window.location.href = 'index.html';
    }, 2000);
                  showToast('welcome to Metaverse','success');
                  return true; 
                }
              }
        
              function validateSignUpForm(){
                let email = document.getElementById('email-SignUp').value.trim();
                let password = document.getElementById('password-SignUp').value.trim();
                let name = document.getElementById('name').value.trim();
              
                if(!name){
                  showToast('Please Enter your Name','error');
                  return; 
                }
        
                if(!email){
                  showToast('Please Enter your email','error');
                  return false; 
                }
        
                if(!password){
                  showToast('Please Enter your password','error');
                  return; 
                }
        
                if(email && password && name){
                  switchLogin();
                  return true; 
                }
              }
        </script>
        
        <style>

         #loginButton{
            height: 2.5rem;
            width: 5rem;
            color: white;
            background-color: red;
            border-radius: 5px;
            margin-left: 82rem;
            margin-top:-20rem;
         }

          /* Overlay Background */
          .overlay {
              position: fixed;
              top:0;
              left: 0;
              /* width: 120rem; */
              /* height: 100vh; */
              width: 100%;
            height: 100%;
              background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black */
              display: flex;
              justify-content: center;
              align-items: center;
              z-index: 1000;
              display: none;
          }
        
          /* Overlay Content */
          .overlay-content {
              /* background: white; */
              background: linear-gradient(90deg, rgb(82, 78, 203) 0%, rgb(185, 96, 201) 39%, rgb(206, 139, 58) 100%);
              padding: 20px;
              border-radius: 10px;
              margin-top: 15rem;
              margin-left: 40rem;
              box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
              text-align: center;
              color: white;
              width: 30%;
              /* max-width: 400px; */
               box-sizing: border-box;
              height: 25rem;
          }
        
          .overlay-content h1 {
              margin-bottom: 15px;
              font-size:2rem;
              font-weight: bold;
          }
        
          .overlay-content button {
              padding: 10px 15px;
              /* background-color: #007BFF; */
              /* background: linear-gradient(90deg, rgb(206, 139, 58) 0%, rgb(185, 96, 201) 100%); */
              background-color: #2F2E41;
              color: white;
              border: none;
              border-radius: 5px;
              cursor: pointer;
          }
        
          .overlay-content button:hover {
              background-color: #0056b3;
          }  
        
        @media(max-width:1260px){
          .overlay-content{
            width: 80%;
            margin-left: 30rem;
          }
        }
        
        /* Make adjustments for larger screens (tablets and small desktops) */
        @media (max-width: 1024px) {
            .overlay-content {
                width: 70%; /* Slightly larger for tablet and medium screens */
                padding: 25px;
            }
            
            .overlay-content{
              margin-top: 17rem;
              margin-left:8rem;
            }
         }  
        
          @media (max-width: 600px) {
            .overlay-content {
                width: 90%; 
                 padding: 15px; 
           }  
        
             .overlay-content h1 { 
                 font-size: 1.25rem; 
           } 
        
             .overlay-content{ 
               margin-top: 10rem; 
               margin-left: 5rem; 
             } 
             .overlay-content input,
             .overlay-content button {
                 font-size: 0.9rem; 
           } 
         } 
        
         @media(max-width: 450px){ 
           .overlay-content{ 
            width: 80%;
             margin-left: .5rem; 
           }
           .overlay-content button,p{ 
             margin-left: 1rem; 
           } 
         } 
        </style>
        
        <!-- log in page  -->
            <div class="overlay" id="overlay">
              <div class="overlay-content">
                <h1>Login Page </h1>
                
                <form onsubmit="return validateLoginInForm()"> 
                <div class="email" style="display: flex; margin-bottom: 2rem;">
                <label for="email" style="padding-top: .2rem;">Email:</label> &nbsp;&nbsp;
                <input placeholder="Enter your email" id="email"  type="email" style="height: 2rem; border: 1px solid blue;">
                </div>
        
        <div class="password" style="display: flex;" >
                <label for="password">Password:</label>&nbsp;&nbsp;
                <input placeholder="Enter your password" id="password" type="password"  style="height:2rem; border: 1px solid blue;">
        </div>
        
        <p style="display: flex; margin-left: 8.5rem; margin-top: 5rem;">Don't have an account? <a href="#signUp" style="color:black;" onclick="switchSignUp()" style="border-bottom:1px solid black ;">  sign in</a></p>
        
        <div class="btn" style="margin-left: 12rem; margin-top: 1rem;">
                 <button  type='submit' style="width: 5.5rem; height: 3rem; font-size: 1.2rem; font-weight: 100;">Log in </button>
        </div>
        </form>
        
        </div> 
            </div>
        
        
        
            <!-- sign up page  -->
            <div class="overlay" id="signUp" style="display: none;">
              <div class="overlay-content">
                <h1>Sign up Page </h1>
        <form onsubmit="return validateSignUpForm()">         
        <div class="name" style="display: flex; margin-bottom: 2rem;">
                  <label for="name" style="padding-top: .2rem;">Name:</label> &nbsp;&nbsp;
                  <input placeholder="Enter your Name" id="name" style="height: 2rem; border: 1px solid blue;">
        </div>
        
        <div class="email" style="display: flex; margin-bottom: 2rem;">
                <label for="email" style="padding-top: .2rem;">Email:</label> &nbsp;&nbsp;
                <input placeholder="Enter your email" id="email-SignUp" style="height: 2rem; border: 1px solid blue;">
        </div>
        
        <div class="password" style="display: flex;" >
                <label for="password">Password:</label>&nbsp;&nbsp;
                <input placeholder="Enter your password" id="password-SignUp" style="height:2rem; border: 1px solid blue;">
        </div>
         <!-- <p style="display: flex; margin-left: 4.5rem; margin-top: 3.5rem;"><a href="#overlay" style="border-bottom:1px solid black ;">Log in</a></p> -->
        <div class="btn" style="margin-left: 12rem; margin-top: 3rem;">
                 <button type="submit" style="width: 6rem; height: 3rem; font-size: 1.2rem; font-weight: 100;" >Sign up </button>
        </div>
        </form>
        
              </div> 
            </div>
        
        

    <div class="navbar">
    
        <div class="nav-cont" id="nav-cont">
        <div class="nav-wrapper">
            <a id="aid" class="nav-link" href="./index.html">
                <i class="fas fa-home"></i> Home
            </a>
            <a id="aid" class="nav-link" href="./about.html">
                <i class="fas fa-info-circle"></i> About
            </a>
         
            <a id="aid" class="nav-link" href="./contact.html">
                <i class="fas fa-envelope"></i> Contact
            </a>
            <a id="aid" class="nav-link" href="RateUs.html">
                <i class="fas fa-star"></i> Rate Us
            </a>
            <a id="aid" class="nav-link" href="./contributor.html">
                <i class="fas fa-users"></i> Contributors
            </a>
        </div>
        <button id="loginButton">Login</button>

    </div>
    <div class="hamburger" onclick="toggleMenu()">
        <i class="fas fa-bars"></i>
      </div>
</div>
    <div class="stargaze">
        <video autoplay loop muted playsinline>
            <source src="./assets/main.webm" type="video/webm">
            <p>Your browser does not support HTML5 video.</p>
        </video>
    </div>  
    <div class="container">
        <div class="emojis">
            <span class="emoji" role="img" aria-label="cry">&#128546;</span>
            <span class="emoji" role="img" aria-label="neutral">&#128528;</span>
            <span class=" emoji" role="img" aria-label="smile">&#128522;</span>
            <span class="emoji" role="img" aria-label="laugh">&#128514;</span>
            <span class="emoji" role="img" aria-label="super">&#128526;</span>
        </div>
        <div class="textarea-container">
            <textarea placeholder="Leave your feedback here..."></textarea>
        </div>
        <div class="email-container">
            <input type="email" placeholder="Enter your email" id="email-input" required>
        </div>
        <button class="submit-button">Submit</button>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
        let feedbackSubmitted = false;

        document.querySelectorAll('.emoji').forEach(emoji => {
            emoji.addEventListener('click', () => {
                if (feedbackSubmitted) {
                    // Allow selecting an emoji again even if feedback was submitted
                    document.querySelectorAll('.emoji').forEach(e => e.classList.remove('selected'));
                    emoji.classList.add('selected');
                } else {
                    document.querySelectorAll('.emoji').forEach(e => e.classList.remove('selected'));
                    emoji.classList.add('selected');
                }
            });
        });

        document.querySelector('.submit-button').addEventListener('click', async () => {
            const selectedEmoji = document.querySelector('.emoji.selected');
            const feedback = document.querySelector('textarea').value;
            const email = document.querySelector('#email-input').value.trim(); // Get the email input value
            
            if (feedbackSubmitted) {
                Toastify({
                    text: "Review already submitted.",
                    backgroundColor: "orange",
                    gravity: "top",
                    position: "center",
                    duration: 3000
                }).showToast();
                // Clear textarea and stop emoji blinking on resubmit attempt
                document.querySelector('textarea').value = '';
                document.querySelector('#email-input').value = ''; // Clear email input
                if (selectedEmoji) {
                    selectedEmoji.classList.remove('selected');
                }
                return;
            }

            if (selectedEmoji && feedback.trim() !== '' && email) {
                try {
                    const result = await fetch("http://localhost:3000/rate-us", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            emoji: selectedEmoji.innerHTML, // Get the selected emoji
                            feedback: feedback,
                            email: email // Include email in the body
                        }),
                    });
                    const res = await result.json();
                    if (res.success) {
                        Toastify({
                            text: "Feedback submitted successfully!",
                            backgroundColor: "green",
                            gravity: "top",
                            position: "center",
                            duration: 3000
                        }).showToast();
                        // Clear the textarea and email input
                        document.querySelector('textarea').value = '';
                        document.querySelector('#email-input').value = '';

                        // Remove the 'selected' class from the emoji to stop blinking
                        selectedEmoji.classList.remove('selected');

                        // Mark feedback as submitted
                        feedbackSubmitted = true;
                    } else {
                        Toastify({
                            text: "Failed to submit feedback. Please try again.",
                            backgroundColor: "red",
                            gravity: "top",
                            position: "center",
                            duration: 3000
                        }).showToast();
                    }
                } catch (e) {
                    Toastify({
                        text: "Server error",
                        backgroundColor: "red",
                        gravity: "top",
                        position: "center",
                        duration: 3000
                    }).showToast();
                }
            } else {
                Toastify({
                    text: "Please select an emoji, provide feedback, and enter your email.",
                    backgroundColor: "red",
                    gravity: "top",
                    position: "center",
                    duration: 3000
                }).showToast();
            }
        });

        function toggleMenu() {
          const navMenu = document.getElementById('nav-cont');
          navMenu.classList.toggle('active');
        }

    </script>
<script>
    const btn = document.getElementById('loginButton');
    const overlay =  document.getElementById('overlay');
    btn.addEventListener("click",function(){
      overlay.style.display = 'block';
    })
  </script>

<!-- toastify script -->
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

</body>

</html>
